!function t(e,r,i){function o(s,a){if(!r[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(n)return n(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=r[s]={exports:{}};e[s][0].call(h.exports,function(t){var r=e[s][1][t];return o(r?r:t)},h,h.exports,t,e,r,i)}return r[s].exports}for(var n="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,r){!function(){"use strict";function t(t,i,o){o.interceptors.push("interceptor"),i.otherwise("/"),t.state("/",{url:"/",templateUrl:"main.html",controller:"mainController",controllerAs:"vm",resolve:{ping:e}}).state("/login",{url:"/login",templateUrl:"login.html",controller:"loginController",controllerAs:"vm",resolve:{checkSession:r}}).state("/reservation",{url:"/reservation/:id/:date",templateUrl:"reservation.html",controller:"reservationController",controllerAs:"vm",resolve:{ping:e}}).state("/tags",{url:"/tags",templateUrl:"tags.html",controller:"tagsController",controllerAs:"vm",resolve:{ping:e}}).state("/spaces",{url:"/spaces",templateUrl:"spaces.html",controller:"spacesController",controllerAs:"vm",resolve:{ping:e}})}function e(t){return t.ping()}function r(t){return t.checkSession()}function i(){return{serviceUrl:"/reservations-offices/api/",genericErrorMessage:"An error has occurred",genericSuccessMessage:"Operation successfully achieved",toasterTime:3e3}}t.$inject=["$stateProvider","$urlRouterProvider","$httpProvider"],angular.module("app").config(t).constant("constants",i()),e.$inject=["ajaxService"],r.$inject=["ajaxService"]}()},{}],2:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r,i,o){this.$scope=t,this.$state=e,this.storeService=r,this.ajaxService=i,this.constants=o,this.currentUser={},this.toasterData={},this.now=Date.now(),this.init()}return t.prototype.init=function(){var t=this;this.$scope.$watch(function(){return t.$state.current},this.updateRoute.bind(this)),this.$scope.$on("ERROR",this.toastError.bind(this)),this.$scope.$on("OK",this.toastSuccess.bind(this)),this.$scope.$on("goToLogin",this.goToLogin.bind(this)),this.$scope.$on("goToRoot",this.goToRoot.bind(this)),this.updateRoute()},t.prototype.goToLogin=function(){this.$state.go("/login")},t.prototype.goToRoot=function(){this.$state.go("/")},t.prototype.toastError=function(t,e){var r=t.name,i=e?e:this.constants.genericErrorMessage;this.toasterData={type:r,message:i}},t.prototype.toastSuccess=function(t,e){var r=t.name,i=e?e:this.constants.genericSuccessMessage;this.toasterData={type:r,message:i}},t.prototype.updateRoute=function(){var t=this;return this.$state.current.name&&"/login"!==this.$state.current.name?(this.getCurrentUser().then(function(){return t.route=t.$state.current.name,!0}),!0):(this.storeService.resetCurrentUser(),this.currentUser={},!1)},t.prototype.getCurrentUser=function(){var t=this;return this.storeService.getCurrentUser().then(function(e){t.currentUser=e})},t.prototype.logout=function(){var t=this;this.storeService.logout().then(function(){t.$state.go("/login")})},t.$inject=["$scope","$state","storeService","ajaxService","constants"],t}();angular.module("app").controller("appController",t)}()},{}],3:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r){this.$scope=t,this.$uibModalInstance=e,this.data=r,this.data=r}return t.prototype.cancel=function(){this.$uibModalInstance.dismiss("delete")},t.prototype.accept=function(){this.$uibModalInstance.close()},t.$inject=["$scope","$uibModalInstance","data"],t}();angular.module("app").controller("confirmationModalController",t)}()},{}],4:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r,i){this.$scope=t,this.$state=e,this.storeService=r,this.ajaxService=i}return t.prototype.login=function(){var t=this;this.status=null,this.ajaxService.login(this.username,this.password).then(function(e){"ERROR"===e.data.status?t.status=e.data.payload:t.$state.go("/")})},t.$inject=["$scope","$state","storeService","ajaxService"],t}();angular.module("app").controller("loginController",t)}()},{}],5:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r,i,o,n){var s=this;this.$scope=t,this.$q=e,this.$rootScope=r,this.$state=i,this.$uibModal=o,this.storeService=n,this.visualization="calendar",this.date=new Date,this.reservations={},this.reservationCount=0,this.loading=!1,this.getReservationList(),this.storeService.getCurrentUser().then(function(t){s.currentUser=t}),this.$scope.$on("deleteReservation",this.deleteReservation.bind(this))}return t.prototype.toastSuccess=function(){var t=this.$q.defer();return this.$rootScope.$broadcast("OK",""),t.resolve(),t.promise},t.prototype.getReservationList=function(){var t=this,e=this.date.getMonth()+1,r=this.date.getFullYear();this.loading=!0,this.storeService.getReservationList(e,r).then(function(e){t.reservations=e,t.loading=!1})},t.prototype.deleteReservation=function(t,e){var r=this,i=this.reservations[e].date,o="About to delete a reservation",n='You are about to delete "'.concat(this.reservations[e].title).concat(" - ").concat(i.getDate().toString()).concat("/").concat(i.getMonth().toString()).concat("/").concat(i.getFullYear().toString()).concat('". This action cannot be reverted, are you sure?'),s=this.$uibModal.open({templateUrl:"confirmation.modal.html",controller:"confirmationModalController",controllerAs:"vm",resolve:{data:{title:o,body:n}}});s.result.then(function(){r.storeService.deleteReservation(e).then(r.toastSuccess.bind(r)).then(function(){r.$scope.$broadcast("updateCalendar")})})},t.prototype.switchVisualization=function(t){this.visualization=t},t.prototype.next=function(){this.date.setMonth(this.date.getMonth()+1),this.getReservationList()},t.prototype.prev=function(){this.date.setMonth(this.date.getMonth()-1),this.getReservationList()},t.prototype.checkVaidity=function(t){var e=t.getTime(),r=(new Date).setDate((new Date).getDate()-1);return e>r},t.$inject=["$scope","$q","$rootScope","$state","$uibModal","storeService"],t}();angular.module("app").controller("mainController",t)}()},{}],6:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r,i,o,n,s,a){this.$scope=t,this.$rootScope=e,this.$state=r,this.$q=i,this.$uibModal=o,this.storeService=n,this.ajaxService=s,this.processService=a,this.$inject=["this.$scope","$rootScope","$state","$q","$uibModal","storeService","ajaxService","processService"],this.reservation={},this.newComment="",this.editableComment=-1,this.editableCommentText="",this.filteredTags={},this.noTagOption={0:{id:0,text:"No tags available"}},this.times=this.getTimes(),this.currentUser={},this.tags={},this.spaces={},this.lastCheck={},this.editEnabled=!0,this.reservationValidity=!0,this.ableToCheckVailidity=!1,this.loading=!1,this.edition={title:null,description:null,body:null,from_time:7,to_time:8,space:1,date:new Date},this.init()}return t.$inject=["$scope","$rootScope","$state","$q","$uibModal","storeService","ajaxService","processService"],t.prototype.init=function(){var t=this;this.$scope.$watchGroup([function(){return t.edition.date},function(){return t.edition.from_time},function(){return t.edition.to_time},function(){return t.edition.space}],this.checkValidity.bind(this)),isNaN(this.$state.params.id)?(this.ableToCheckVailidity=!0,this.$state.params.date&&!isNaN(this.$state.params.date)&&(this.edition.date=new Date(Number(this.$state.params.date))),this.$q.all([this.getCurrentUser(),this.getTags(),this.getSpaces()]).then(this.filterTags.bind(this))):this.getCurrentUser().then(this.getReservation.bind(this)).then(function(){t.ableToCheckVailidity=!0,t.getComments(),t.checkValidity(),t.$q.all([t.getReservationTagList(),t.getTags(),t.getSpaces()]).then(t.filterTags.bind(t))})},t.prototype.getTimes=function(){for(var t=[],e=1;e<=24;e++)t.push(e);return t},t.prototype.toastSuccess=function(){var t=this.$q.defer();return this.$rootScope.$broadcast("OK",""),t.resolve(),this.loading=!1,t.promise},t.prototype.getCurrentUser=function(){var t=this;return this.storeService.getCurrentUser().then(function(e){t.currentUser=e})},t.prototype.checkValidity=function(){var t=this,e=this.reservation.id,r=this.processService.addZeros(this.edition.date.getDate()),i=this.processService.addZeros(this.edition.date.getMonth()+1),o=this.edition.date.getFullYear(),n=this.edition.from_time,s=this.edition.to_time,a=this.edition.space,c={id:e,day:r,month:i,year:o,from:n,to:s,space:a},u=Boolean(!!(r&&i&&o&&n&&s&&a));return this.ableToCheckVailidity&&u&&!angular.equals(c,this.lastCheck)?(this.lastCheck=c,void this.ajaxService.reservationValidity(e,r,i,o,n,s,a).then(function(e){t.reservationValidity=e.data.payload})):(this.reservationValidity=!1,!1)},t.prototype.getReservation=function(){var t=this,e=this.$q.defer();return this.storeService.getReservation(this.tempId?this.tempId:this.$state.params.id).then(function(r){t.reservation=r,t.edition=Object.assign({},r),t.editEnabled=t.currentUser.id===r.creation_user&&r.date.getTime()>Date.now(),e.resolve()}).catch(function(){t.$state.go("/reservation",{id:"new",date:Date.now()}),t.storeService.resetReservations(),e.reject()}),e.promise},t.prototype.getComments=function(){return this.storeService.getComments(this.reservation.id)},t.prototype.getReservationTagList=function(){return this.storeService.getReservationTagList(this.reservation.id)},t.prototype.getTags=function(){var t=this;return this.storeService.getTags().then(function(e){t.tags=e})},t.prototype.getSpaces=function(){var t=this;return this.storeService.getSpaces().then(function(e){t.spaces=e})},t.prototype.filterTags=function(){var t,e={};if(!this.reservation.id)return this.filteredTags=this.noTagOption,this.selectedTag=this.filteredTags[Object.keys(this.filteredTags)[0]],!1;for(var r in this.tags){t=!0;for(var i in this.reservation.tags)if(i===this.tags[r].id){t=!1;break}t&&(e[r]=Object.assign({},this.tags[r]))}this.filteredTags=e,Object.keys(this.filteredTags).length||(this.filteredTags=this.noTagOption),this.selectedTag=this.filteredTags[Object.keys(this.filteredTags)[0]]},t.prototype.setReservation=function(){var t=this;this.edition.title=this.edition.title?this.edition.title:" ",this.loading=!0;var e={title:this.edition.title,description:this.edition.description,body:this.edition.body,date:this.edition.date,from:this.edition.from_time,to:this.edition.to_time,space:this.edition.space,reservation_id:this.reservation.id};return this.storeService.setReservation(e).then(function(e){t.lastCheck=null,t.reservation.id||(t.tempId=e,t.$state.go("/reservation",{id:e},{notify:!1,reload:!1,location:"replace",inherit:!0}))}).then(this.toastSuccess.bind(this))},t.prototype.toggleEdit=function(){this.editEnabled=!this.editEnabled,this.editEnabled||(this.edition=Object.assign({},this.reservation))},t.prototype.saveReservation=function(){var t=this.edition.date,e="About to save a reservation",r='You are about to save "'.concat(this.edition.title).concat(" - ").concat(t.getDate().toString()).concat("/").concat(t.getMonth().toString()).concat("/").concat(t.getFullYear().toString()).concat('". Are you sure?'),i=this.$uibModal.open({templateUrl:"confirmation.modal.html",controller:"confirmationModalController",controllerAs:"vm",resolve:{data:{title:e,body:r}}});i.result.then(this.setReservation.bind(this)).then(this.getReservation.bind(this)).then(this.getReservationTagList.bind(this)).then(this.getComments.bind(this)).then(this.filterTags.bind(this))},t.prototype.saveComment=function(){var t=this;return this.loading=!0,this.storeService.setComment(this.newComment,this.reservation.id).then(function(){t.newComment=""}).then(this.toastSuccess.bind(this))},t.prototype.updateComment=function(t){return this.loading=!0,this.storeService.setComment(this.editableCommentText,null,t).then(this.toastSuccess.bind(this)).then(this.editComment.bind(this))},t.prototype.editComment=function(t,e){this.editableCommentText="",this.editableComment===t?this.editableComment=-1:(this.editableComment=t,this.editableCommentText=e?this.reservation.comments[e].text:"")},t.prototype.deleteComment=function(t){var e=this,r=(this.edition.date,"About to delete a comment"),i="Are you sure?",o=this.$uibModal.open({templateUrl:"confirmation.modal.html",controller:"confirmationModalController",controllerAs:"vm",resolve:{data:{title:r,body:i}}});o.result.then(function(){return e.loading=!0,e.storeService.deleteComment(t,e.reservation.id).then(e.toastSuccess.bind(e))})},t.prototype.setTag=function(){return this.loading=!0,this.storeService.setTag(this.reservation.id,this.selectedTag.id).then(this.getReservationTagList.bind(this)).then(this.toastSuccess.bind(this)).then(this.filterTags.bind(this))},t.prototype.deleteTag=function(t){return this.loading=!0,this.storeService.deleteTag(this.reservation.id,t).then(this.toastSuccess.bind(this)).then(this.filterTags.bind(this))},t}();angular.module("app").controller("reservationController",t)}()},{}],7:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e){this.$scope=t,this.storeService=e,this.init()}return t.prototype.init=function(){var t=this;this.storeService.getSpaces().then(function(e){t.spaces=e})},t.$inject=["$scope","storeService"],t}();angular.module("app").controller("spacesController",t)}()},{}],8:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e){this.$scope=t,this.storeService=e,this.init()}return t.prototype.init=function(){var t=this;this.storeService.getTags().then(function(e){t.tags=e})},t.$inject=["$scope","storeService"],t}();angular.module("app").controller("tagsController",t)}()},{}],9:[function(t,e,r){!function(){"use strict";function t(t,e,r){function i(){t.days=[],t.checkVaidity=a,t.getNewHref=c,t.delete=u,t.$watch("data",o),t.$on("updateCalendar",o)}function o(){var e=t.date.getMonth(),r=t.date.getFullYear(),i=n(e,r),o=0;i=i.map(function(e){e.items=[],e.empty=!0;for(var r in t.data)s(e.date,t.data[r].date)&&(e.items.push(t.data[r]),e.empty=!1,o++);return e}),t.count=o,t.days=i}function n(t,e){for(var r=new Date(e,t,1),i=[];r.getMonth()===t;)i.push({date:new Date(r)}),r.setDate(r.getDate()+1);return i}function s(t,e){return t.getTime()===e.getTime()}function a(t){var e=t.getTime(),r=(new Date).setDate((new Date).getDate()-1);return e>r}function c(t){return a(t)?"#/reservation/new/".concat(t.getTime().toString()):""}function u(e){t.$emit("deleteReservation",e)}t.checkVaidity=a,t.getNewHref=c,t.deleteReservation=u,i()}var e=function(){return{restrict:"E",templateUrl:"calendar.directive.html",link:t,scope:{data:"=",date:"=",count:"=",user:"=",newReservation:"="}}};angular.module("app").directive("calendar",e)}()},{}],10:[function(t,e,r){!function(){"use strict";function t(t){var e=function(){function e(t,e,r){this.$scope=t,this.$element=e,this.timeout=0,this.$scope.$watch("data",this.toast)}return e.prototype.toast=function(){var e=this;return!!this.$scope.data.type&&(clearTimeout(this.timeout),this.timeout=setTimeout(function(){e.$scope.data={},e.$scope.$digest()},t.toasterTime),!0)},e}();return{restrict:"E",templateUrl:"toaster.directive.html",link:e,scope:{data:"="}}}angular.module("app").directive("toaster",t),t.$inject=["constants"]}()},{}],11:[function(t,e,r){!function(){"use strict";function t(){return function(t){var e;return e=t.getTime()}}angular.module("app").filter("dateToNumber",t)}()},{}],12:[function(t,e,r){!function(){"use strict";function t(){return function(t){var e;switch(t=String(t)){case"1":e="A";break;case"2":e="B";break;case"3":e="C";break;case"4":e="D";break;case"5":e="E";break;case"6":e="F";break;case"7":e="G";break;default:e="invalid time"}return e}}angular.module("app").filter("department",t)}()},{}],13:[function(t,e,r){!function(){"use strict";function t(){return function(t,e){t=[].concat(t);for(var r=0;r<t.length;r++)t[r]>=e&&(t.splice(r,1),r--);return t}}angular.module("app").filter("fromTimeFilter",t)}()},{}],14:[function(t,e,r){!function(){"use strict";function t(){return function(t,e){var r={};for(var i in t)t[i].date.getMonth()===e.getMonth()&&t[i].date.getFullYear()===e.getFullYear()&&(r[i]=t[i]);return r}}angular.module("app").filter("monthFilter",t)}()},{}],15:[function(t,e,r){!function(){"use strict";function t(){function t(t,e,r){var i=t[r],o=e[r];return i.getTime&&o.getTime&&(i=i.getTime(),o=o.getTime()),i>o?1:-1}return function(e,r){var i=[];for(var o in e)e.hasOwnProperty(o)&&i.push(e[o]);return r.forEach(function(e){i=i.sort(function(r,i){return t(r,i,e)})}),i}}angular.module("app").filter("repeatObjectToArrayFilter",t)}()},{}],16:[function(t,e,r){!function(){"use strict";function t(){return function(t){var e;switch(t=String(t)){case"1":e="Morning";break;case"2":e="Evening";break;case"3":e="Afternoon";break;default:e=""}return e}}angular.module("app").filter("time",t)}()},{}],17:[function(t,e,r){!function(){"use strict";function t(){return function(t,e){t=[].concat(t);for(var r=0;r<t.length;r++)t[r]<=e&&(t.splice(r,1),r--);return t}}angular.module("app").filter("toTimeFilter",t)}()},{}],18:[function(t,e,r){"use strict";t("./modules/app.module"),t("./config"),t("./services/interceptor.service"),t("./services/process.service"),t("./services/ajax.service"),t("./services/store.service"),t("./filters/time.filter"),t("./filters/department.filter"),t("./filters/month.filter"),t("./filters/dateToNumber.filter"),t("./filters/fromTime.filter"),t("./filters/toTime.filter"),t("./filters/repeatObjectToArray.filter"),t("./directives/toaster.directive"),t("./directives/calendar.directive"),t("./controllers/app.controller"),t("./controllers/login.controller"),t("./controllers/main.controller"),t("./controllers/confirmationModal.controller"),t("./controllers/reservation.controller"),t("./controllers/tags.controller"),t("./controllers/spaces.controller")},{"./config":1,"./controllers/app.controller":2,"./controllers/confirmationModal.controller":3,"./controllers/login.controller":4,"./controllers/main.controller":5,"./controllers/reservation.controller":6,"./controllers/spaces.controller":7,"./controllers/tags.controller":8,"./directives/calendar.directive":9,"./directives/toaster.directive":10,"./filters/dateToNumber.filter":11,"./filters/department.filter":12,"./filters/fromTime.filter":13,"./filters/month.filter":14,"./filters/repeatObjectToArray.filter":15,"./filters/time.filter":16,"./filters/toTime.filter":17,"./modules/app.module":19,"./services/ajax.service":20,"./services/interceptor.service":21,"./services/process.service":22,"./services/store.service":23}],19:[function(t,e,r){!function(){"use strict";angular.module("app",["ui.router","ngAnimate","ui.bootstrap"])}()},{}],20:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r){this.$http=t,this.$httpParamSerializerJQLike=e,this.constants=r,this.url=this.constants.serviceUrl.concat("?route=")}return t.prototype.ping=function(){return this.$http.get(this.url.concat("ping"))},t.prototype.checkSession=function(){return this.$http.get(this.url.concat("checkSession"))},t.prototype.login=function(t,e){return this.$http({url:this.url.concat("login"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({username:t,password:e})})},t.prototype.logout=function(){return this.$http.get(this.url.concat("logout"))},t.prototype.getCurrentUser=function(){return this.$http.get(this.url.concat("getCurrentUser"))},t.prototype.reservationValidity=function(t,e,r,i,o,n,s){return this.$http.get(this.url.concat("reservationValidity&day=").concat(e).concat("&month=").concat(r).concat("&year=").concat(i).concat("&from=").concat(o).concat("&to=").concat(n).concat("&space=").concat(s).concat("&id=").concat(t))},t.prototype.getReservation=function(t){return this.$http.get(this.url.concat("getReservation&id=").concat(t.toString()))},t.prototype.getReservationList=function(t,e){return this.$http.get(this.url.concat("getReservationList&month=").concat(t.toString()).concat("&year=").concat(e.toString()))},t.prototype.getReservationTagList=function(t){return this.$http.get(this.url.concat("getReservationTagList&reservation_id=").concat(t.toString()))},t.prototype.getComments=function(t){return this.$http.get(this.url.concat("getComments&reservation_id=").concat(t.toString()))},t.prototype.getTags=function(){return this.$http.get(this.url.concat("getTags"))},t.prototype.getSpaces=function(){return this.$http.get(this.url.concat("getSpaces"))},t.prototype.saveReservation=function(t){return this.$http({url:this.url.concat("saveReservation"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike(t)})},t.prototype.updateReservation=function(t){return this.$http({url:this.url.concat("updateReservation"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike(t)})},t.prototype.deleteReservation=function(t){return this.$http({url:this.url.concat("deleteReservation"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({reservation_id:t})})},t.prototype.addTag=function(t,e){return this.$http({url:this.url.concat("addTag"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({reservation_id:t,tag_id:e})})},t.prototype.removeTag=function(t,e){return this.$http({url:this.url.concat("removeTag"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({reservation_id:t,tag_id:e})})},t.prototype.saveComment=function(t,e){return this.$http({url:this.url.concat("saveComment"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({comment:t,reservation_id:e})})},t.prototype.deleteComment=function(t){return this.$http({url:this.url.concat("deleteComment"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({comment_id:t})})},t.prototype.updateComment=function(t,e){return this.$http({url:this.url.concat("updateComment"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({comment_id:e,comment:t})})},t.prototype.saveTag=function(t){return this.$http({url:this.url.concat("saveTag"),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$httpParamSerializerJQLike({tag:t})})},t.$inject=["$http","$httpParamSerializerJQLike","constants"],t}();angular.module("app").service("ajaxService",t)}()},{}],21:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e){this.$q=t,this.$rootScope=e}return t.prototype.request=function(t){return t},t.prototype.requestError=function(t){return this.$q.reject(t)},t.prototype.response=function(t){return"ERROR"===t.data.status?(this.$rootScope.$broadcast("ERROR",t.data.payload),this.$q.reject(t)):t},t.prototype.responseError=function(t){return 403===t.status&&this.$rootScope.$broadcast("goToLogin"),400===t.status&&this.$rootScope.$broadcast("goToRoot"),this.$q.reject(t)},t.$inject=["$q","$rootScope"],t}();angular.module("app").service("interceptor",t)}()},{}],22:[function(t,e,r){!function(){"use strict";var t=function(){function t(){}return t.prototype.addZeros=function(t){return t<10?"0".concat(t.toString()):t.toString()},t.prototype.dbArrayAdapter=function(t){var e,r={},i={};return"object"!=typeof t?i:(t.forEach(function(t){i={};for(var o in t)e=t[o],new RegExp("timestamp","i").test(o)&&(e=new Date(e)),"DATE"===o&&(e=new Date(e.replace("-","/").replace("-","/"))),!isNaN(e)&&"string"==typeof e&&e.trim()&&(e=Number(e)),i[o.toLowerCase()]=e;r[i.id]=i}),r)},t.$inject=[],t}();angular.module("app").service("processService",t)}()},{}],23:[function(t,e,r){!function(){"use strict";var t=function(){function t(t,e,r){this.ajaxService=t,this.processService=e,this.$q=r,this.reservations={},this.comments={},this.tags={},this.spaces={},this.currentUser={}}return t.prototype.logout=function(){var t=this,e=this.$q.defer();return this.ajaxService.logout().then(function(){t.resetCurrentUser(),t.resetReservations(),t.resetTags(),t.resetComments(),e.resolve()}),e.promise},t.prototype.getCurrentUser=function(){var t=this,e=null,r=!1;return this.currentUserDefer||(r=!0,this.currentUserDefer=this.$q.defer()),this.currentUser.id&&this.currentUserDefer.resolve(this.currentUser),!this.currentUser.id&&r&&this.ajaxService.getCurrentUser().then(function(r){e=t.processService.dbArrayAdapter([r.data.payload]),t.currentUser=e[Object.keys(e)[0]],t.currentUserDefer.resolve(t.currentUser)}),this.currentUserDefer.promise},t.prototype.getReservation=function(t){var e,r=this,i=this.$q.defer();return this.reservations[t]?i.resolve(this.reservations[t]):this.ajaxService.getReservation(t).then(function(o){return o.data.payload.length?(e=r.processService.dbArrayAdapter(o.data.payload),r.reservations[t]=e[Object.keys(e)[0]],void i.resolve(r.reservations[t])):(i.reject(),i.promise)}),i.promise},t.prototype.getReservationList=function(t,e){var r=this,i=this.$q.defer();return this.ajaxService.getReservationList(t,e).then(function(t){r.reservations=Object.assign(r.processService.dbArrayAdapter(t.data.payload),r.reservations),i.resolve(r.reservations)}),i.promise},t.prototype.getReservationTagList=function(t){var e,r=this,i=this.$q.defer();return this.ajaxService.getReservationTagList(t).then(function(o){e=r.processService.dbArrayAdapter(o.data.payload),Object.assign(r.tags,e),r.reservations[t].tags=e,i.resolve(e)}),i.promise},t.prototype.getComments=function(t){var e,r=this,i=this.$q.defer();return this.ajaxService.getComments(t).then(function(o){e=r.processService.dbArrayAdapter(o.data.payload),Object.assign(r.comments,e),r.reservations[t].comments=e,i.resolve()}),i.promise},t.prototype.getTags=function(){var t=this,e=this.$q.defer();return Object.keys(this.tags).length?e.resolve(this.tags):this.ajaxService.getTags().then(function(r){t.tags=Object.assign(t.processService.dbArrayAdapter(r.data.payload),t.tags),e.resolve(t.tags)}),e.promise},t.prototype.getSpaces=function(){var t=this,e=this.$q.defer();return Object.keys(this.spaces).length?e.resolve(this.spaces):this.ajaxService.getSpaces().then(function(r){t.spaces=Object.assign(t.processService.dbArrayAdapter(r.data.payload),t.spaces),e.resolve(t.spaces)}),e.promise},t.prototype.setReservation=function(t){var e=this,r=this.$q.defer();return t.reservation_id?this.ajaxService.updateReservation(t).then(function(i){e.resetReservation(t.reservation_id),r.resolve(t.reservation_id)}):this.ajaxService.saveReservation(t).then(function(t){r.resolve(t.data.payload)}),r.promise},t.prototype.setTag=function(t,e,r){var i=this.$q.defer();return this.ajaxService.addTag(t,e).then(function(t){i.resolve(t.data.payload)}),i.promise},t.prototype.setComment=function(t,e,r){var i=this,o=this.$q.defer(),n={};return t&&r?this.ajaxService.updateComment(t,r).then(function(e){i.comments[r].text=t,o.resolve(e)}):this.ajaxService.saveComment(t,e).then(function(r){n={id:r.data.payload,text:t,creation_timestamp:new Date,creation_user:i.currentUser.id,floor:i.currentUser.floor,department:i.currentUser.department},i.comments[r.data.payload]=n,i.reservations[e].comments[r.data.payload]=n,o.resolve(r)}),o.promise},t.prototype.deleteTag=function(t,e){var r=this,i=this.$q.defer();return this.ajaxService.removeTag(t,e).then(function(o){delete r.reservations[t].tags[e],i.resolve()}),i.promise},t.prototype.deleteReservation=function(t){var e=this,r=this.$q.defer();return this.ajaxService.deleteReservation(t).then(function(i){if(e.reservations[t].comments)for(var o in e.reservations[t].comments)delete e.comments[o];delete e.reservations[t],r.resolve(i)}),r.promise},t.prototype.deleteComment=function(t,e){var r=this,i=this.$q.defer();return this.ajaxService.deleteComment(t).then(function(o){delete r.comments[t],delete r.reservations[e].comments[t],i.resolve(o)}),i.promise},t.prototype.resetReservations=function(){this.reservations={}},t.prototype.resetReservation=function(t){delete this.reservations[t]},t.prototype.resetTags=function(){this.tags={}},t.prototype.resetComments=function(){this.comments={}},t.prototype.resetCurrentUser=function(){this.currentUserDefer=null,this.currentUser={}},t.$inject=["ajaxService","processService","$q"],t}();angular.module("app").service("storeService",t)}()},{}]},{},[18]);